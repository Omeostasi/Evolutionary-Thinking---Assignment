# HAND-IN 3
Loading paper data - 230 West Eurasians who lived between 6500 and 300 bc - by Mathieson et al. 2015 on Nature
```{r}
library(tidyverse)
```
# Exercise 1
Plot the first two principal components of the dataWE.txt.zip dataset. Use the ModAnc column to color the points.
--->

```{r}
WE_table <- read.table(file = 'dataWE.txt',sep = "", header = TRUE) # sep = '' consider any white space
```

Plot the first two principal components of "dataWE.txt", color based on "ModAnc"
```{r}
ggplot(WE_table, aes(PC1,PC2))+
  geom_jitter(aes(color = ModAnc)) # jitter adds noise to avoid overplotting
```



We also tried to to make the plot as "Extended Data Figure 4.A" from the paper by Mathieson et al. 2015 on Nature.
Plotting the ancient DNA data over the modern DNA data.
```{r}
ggplot(WE_table, aes(PC1,PC2))+
  geom_point(alpha = 0.1) +
  geom_jitter(data = WE_table |> filter(!ModAnc=="Modern"), aes(color = ModAnc))
```
This plot in chunk 2 has less categories that the one in the paper because they divided:
"Early-farmer" in "Early Farmer (AN - Anatolian Neolithic)", "Early Farmer (CEM - Central European Early & Middle Neolithic)", Early farmer (INC - Iberian Neolithic & Chalcolithic)";
"Steppe" in "Steppe Ancestry (CLB - Central European Late Neolithic & Bronze Age)", "Steppe Ancestry (STP - Steppe)".

# Exercise 2

Subset the dataset to the English, Norwegian, Finnish and Icelandic population (using the POP column) and plot the result (PC1 vs. PC2). Interpret the relationship between populations (e.g., which populations cluster together, is this expected given the geography of the populations, how do the PCs split the populations?).
---> 
Considering geographical and historical features of the population, we would expect Icelandic and Norwegian populations to be the most close related. We also would expect Norwegian, Icelandic, English populations to be more related with each other than to Finnish population.

```{r}
ggplot(data = WE_table |> filter(POP %in% c('English', 'Norwegian', "Finnish", "Icelandic")), #filtering
       aes(x = PC1, y = PC2, colour = POP)
         )+
  geom_jitter()+
  labs(title = "Relationship between Norwegian, Finnish, Icelandic, English Populations")
```
The graph seems to prove our assumptions.

# Exercise 3

Subset the dataset to four populations of your choice and plot the result. Interpret the relationship between populations.
--->
```{r}
our_choice <- c("Sicilian", "French", "Italian_North", "Spanish", "English")
ggplot(data = WE_table |> filter(POP %in% our_choice), #Filtering on our choices
       aes(x = PC1, y = PC2, colour = POP) 
       )+
  geom_jitter()+
  labs(title = "Relationship between Sicilian, French, North of Italy, Spanish Populations")
```
From the resulting graph it's possible to infer that people from the north of Italy in the dataset are more close related to Spanish and French populations than the Sicilian people.

# Exercise 4
Plot the third and fourth principal component (of the four populations). Has the relationship between populations changed?
--->
```{r}
ggplot(data = WE_table |>  filter(POP %in% our_choice), #Filtering on our choices
       aes(x = PC3, y = PC4, colour = POP)
       )+
  geom_jitter()+
  labs(title = "Relationship between Sicilian, French, North of Italy, and Spanish Populations")
```
This graph shows different relationship compared to the one showing the correlation between PC1 and PC2.
Now the Sicilian population is close related to the Spanish population even more than the people from the north of Italy.
```{r}
filtered <-  WE_table |> filter(POP%in% our_choice)
```

# Exercise 5
Plot some other combinations of PC5-PC10 (of the four populations). What can you observe with respect to the separation of populations on the plots (is it better or worse compared to PC1-PC4 plots)? Why?
---> 
```{r}
# PC6 and PC7
ggplot(data = WE_table |>  filter(POP %in% our_choice), #Filtering on our choices
       aes(x = PC6, y = PC7, colour = POP)
       )+
  geom_jitter()+
  labs(title = "Relationship between Sicilian, French, North of Italy, and Spanish Populations")

# PC7 and PC8
ggplot(data = WE_table |>  filter(POP %in% our_choice), #Filtering on our choices
       aes(x = PC7, y = PC8, colour = POP)
       )+
  geom_jitter()+
  labs(title = "Relationship between Sicilian, French, North of Italy, and Spanish Populations")

# PC5 and PC10
ggplot(data = WE_table |> filter(POP %in% our_choice), #Filtering on our choices
       aes(x = PC5, y = PC10, colour = POP)
       )+
  geom_jitter()+
  labs(title = "Relationship between Sicilian, French, North of Italy, and Spanish Populations")
```
In all the above the combinations between the different principal components (PCs) there are no clear clusters and all the populations are mixed compared to the previous PCs combinations.
The reason behind this behavior is related to the way in which the principal components are calculated and what they are.
The principal component analysis (PCA) is a statistical instrument that has as principal aim the one of creating vectors that reduce the variance between the different variables. The first two PCs are the one which takes the most variance between the sample while the others principal components reduce the variables with less variance between them.
